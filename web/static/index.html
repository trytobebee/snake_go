<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ Snake Game - Web Version</title>
    <link rel="stylesheet" href="style.css?v=5.1">
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="game-header">
            <h1>ğŸ SNAKE GAME</h1>
            <p class="subtitle">Web Version - Premium Edition</p>
            <div id="userInfoBar" class="user-info-bar hidden">
                <span class="user-welcome">ğŸ‘‹ Welcome, <strong id="displayUsername">Player</strong></span>
                <button id="btnLogoutUser" class="nav-logout-btn">Logout</button>
            </div>
        </header>

        <!-- Stats Panel -->
        <div class="stats-panel">
            <div class="stat-item highlight">
                <span class="stat-label">Best Score</span>
                <span class="stat-value" id="bestScore">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Score</span>
                <span class="stat-value" id="score">0</span>
            </div>
            <div class="stat-item ai-stat">
                <span class="stat-label">AI Score</span>
                <span class="stat-value" id="aiScore">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Speed</span>
                <span class="stat-value" id="speed">0.00</span>
                <span class="stat-unit">ä¸ª/ç§’</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Eaten</span>
                <span class="stat-value" id="eaten">0</span>
            </div>
            <div class="stat-item highlight timer">
                <span class="stat-label">Time Left</span>
                <span class="stat-value" id="timeLeft">30</span>
                <span class="stat-unit">s</span>
            </div>
            <div class="stat-item user-stats">
                <span class="stat-label">Win Rate</span>
                <span class="stat-value" id="winRate">0%</span>
                <span class="stat-unit" id="gamesWon">0/0</span>
            </div>
            <div class="stat-item boost-indicator" id="boostIndicator">
                <span class="boost-icon">ğŸš€</span>
                <span class="boost-text">BOOST!</span>
            </div>
        </div>

        <!-- Mode Selector -->
        <div class="mode-panel">
            <span class="panel-label">Game Mode:</span>
            <div class="mode-options">
                <button class="mode-btn active" id="mode-battle">âš”ï¸ Battle</button>
                <button class="mode-btn" id="mode-zen">ğŸ§˜ Zen</button>
                <button class="mode-btn" id="mode-pvp">ğŸ‘¥ P2P Battle</button>
            </div>
            <div class="berserker-toggle" id="berserker-toggle" title="ğŸ‘¹ Toggle Aggressive AI">
                <span class="berserker-icon">ğŸ‘¹</span>
                <span class="berserker-label">Berserker</span>
            </div>
        </div>

        <!-- Difficulty Selector -->
        <div class="difficulty-panel">
            <span class="panel-label">Difficulty:</span>
            <div class="difficulty-options">
                <button class="diff-btn" data-diff="low" id="diff-low">Low</button>
                <button class="diff-btn active" data-diff="mid" id="diff-mid">Medium</button>
                <button class="diff-btn" data-diff="high" id="diff-high">High</button>
            </div>
            <div class="auto-toggle">
                <button class="auto-btn" id="btn-auto">ğŸ¤– Auto-Play</button>
                <select id="auto-mode" class="auto-select">
                    <option value="neural">ğŸ§  Neural (RL)</option>
                    <option value="heuristic" selected>ğŸ“ Heuristic (Rule-based)</option>
                </select>
            </div>
        </div>

        <!-- Game Canvas -->
        <div class="game-container">
            <canvas id="gameCanvas"></canvas>
            <div class="game-overlay" id="gameOverlay">
                <div class="overlay-content">
                    <h2 id="overlayTitle">Ready to Play?</h2>
                    <p id="overlayMessage">Press SPACE to start</p>
                    <button id="cancelMatchBtn" class="cancel-btn hidden">Cancel Search</button>

                </div>
            </div>
            <!-- Mobile Controls -->
            <div class="mobile-controls">
                <div class="control-row">
                    <button class="mobile-btn" id="btn-up">â–²</button>
                </div>
                <div class="control-row">
                    <button class="mobile-btn" id="btn-left">â—€</button>
                    <button class="mobile-btn secondary" id="btn-pause">â¸</button>
                    <button class="mobile-btn fire" id="btn-fire">ğŸ”¥</button>
                    <button class="mobile-btn" id="btn-right">â–¶</button>
                </div>
                <div class="control-row">
                    <button class="mobile-btn" id="btn-down">â–¼</button>
                </div>
            </div>
        </div>

        <!-- Leaderboard Panel -->
        <div class="leaderboard-panel">
            <h3>ğŸ† Hall of Fame</h3>
            <div class="leaderboard-tabs">
                <button class="tab-btn active" id="tabScore">Top Scores</button>
                <button class="tab-btn" id="tabWinRate">Win Rates</button>
            </div>
            <div id="leaderboardList" class="leaderboard-list">
                <p class="loading-text">Loading scores...</p>
            </div>
        </div>

        <!-- Controls Info -->
        <div class="controls-panel">
            <h3>ğŸ® Controls</h3>
            <div class="controls-grid">
                <div class="control-item">
                    <kbd>â†‘</kbd><kbd>â†“</kbd><kbd>â†</kbd><kbd>â†’</kbd>
                    <span>or</span>
                    <kbd>W</kbd><kbd>A</kbd><kbd>S</kbd><kbd>D</kbd>
                    <span>Move</span>
                </div>
                <div class="control-item">
                    <kbd>Space</kbd>
                    <span>Pause</span>
                </div>
                <div class="control-item">
                    <kbd>R</kbd>
                    <span>Restart</span>
                </div>
                <div class="control-item">
                    <kbd>P</kbd>
                    <span>Auto-Play</span>
                </div>
                <div class="control-item">
                    <kbd>F</kbd> / <kbd>Enter</kbd>
                    <span>Fire! ğŸ”¥</span>
                </div>
                <div class="control-item">
                    <span class="tip">ğŸ’¡ Hold direction key for ğŸš€ BOOST!</span>
                </div>
            </div>
        </div>

        <!-- Legend -->
        <div class="legend">
            <h3>ğŸ¯ Food Types</h3>
            <div class="legend-grid">
                <div class="legend-item">
                    <span class="food-icon red">ğŸ”´</span>
                    <span>Red: 40pts (10s)</span>
                </div>
                <div class="legend-item">
                    <span class="food-icon orange">ğŸŸ </span>
                    <span>Orange: 30pts (15s)</span>
                </div>
                <div class="legend-item">
                    <span class="food-icon blue">ğŸ”µ</span>
                    <span>Blue: 20pts (18s)</span>
                </div>
                <div class="legend-item">
                    <span class="food-icon purple">ğŸŸ£</span>
                    <span>Purple: 10pts (20s)</span>
                </div>
            </div>
            <div class="bonus-info">
                <p>ğŸ† Corner Bonus: <strong>+100 pts</strong></p>
                <p>â­ Edge Bonus: <strong>+30 pts</strong></p>
            </div>
        </div>

        <!-- Auth Overlay -->
        <div class="auth-overlay" id="authOverlay">
            <div class="auth-content">
                <h2 id="authTitle">SNAKE LOGIN</h2>
                <div class="auth-form">
                    <input type="text" id="authUsername" placeholder="Username" maxlength="15">
                    <input type="password" id="authPassword" placeholder="Password">
                    <div class="auth-options">
                        <label class="remember-me">
                            <input type="checkbox" id="authRemember" checked>
                            <span>Remember Me</span>
                        </label>
                    </div>
                    <div class="auth-actions">
                        <button id="btnLogin">Login</button>
                        <button id="btnRegister" class="secondary">Register</button>
                    </div>
                </div>
                <p id="authMessage"></p>
            </div>
        </div>

        <!-- Connection Status -->
        <div class="connection-status" id="connectionStatus">
            <span class="status-dot"></span>
            <span class="status-text">Connecting...</span>
            <span class="ping-display" id="pingDisplay">Ping: -- ms</span>
            <span class="player-count" id="totalPlayers">ğŸ‘¥ 0 Players</span>
        </div>

        <!-- Feedback UI -->
        <div class="feedback-trigger" id="feedback-trigger">
            <span>ğŸ’¬ Feedback</span>
        </div>

        <div class="auth-overlay hidden" id="feedbackOverlay">
            <div class="auth-content feedback-content">
                <h2>ğŸ“£ YOUR FEEDBACK</h2>
                <p>Help us improve the game!</p>
                <textarea id="feedbackText" placeholder="Found a bug? Have an idea? Write here..."
                    maxlength="500"></textarea>
                <div class="auth-actions">
                    <button id="btnSendFeedback">Submit</button>
                    <button id="btnCancelFeedback" class="secondary">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/protobufjs@7.2.4/dist/protobuf.min.js"></script>
    <script type="module" src="game.js?v=2.4"></script>

</body>

</html>